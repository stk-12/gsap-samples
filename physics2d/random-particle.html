<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Physics2D Particle</title>
<link rel="stylesheet" href="../assets/css/common.css">
<style>
  body {
    margin: 0;
    background: #111;
    height: 100vh;
    cursor: pointer;
  }
  h1 {
    font-size: 3vw;
    font-weight: 400;
    color: rgba(255, 255, 255, 0.5);
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
  }
  .particle {
    position: fixed;
    width: 8px;
    height: 8px;
    background: #FF6F61;
    border-radius: 50%;
    pointer-events: none;
  }
</style>

</head>
<body>
  <h1>Click Anywhere</h1>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/Physics2DPlugin.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/lil-gui@0.18/dist/lil-gui.umd.min.js"></script>
<script>
gsap.registerPlugin(Physics2DPlugin);

// lil-guiで編集するパラメータ
const params = {
  count: 20,
  angleMin: 0,
  angleMax: 360,
  velocityMin: 200,
  velocityMax: 500,
  gravity: 800,
  friction: 0,
};

// lil-guiのセットアップ
const gui = new lil.GUI();
gui.add(params, 'count', 1, 100, 1).name('パーティクル数');
gui.add(params, 'angleMin', 0, 360, 1).name('最小角度');
gui.add(params, 'angleMax', 0, 360, 1).name('最大角度');
gui.add(params, 'velocityMin', 0, 1000, 1).name('最小速度');
gui.add(params, 'velocityMax', 0, 1000, 1).name('最大速度');
gui.add(params, 'gravity', 0, 2000, 1).name('重力');
gui.add(params, 'friction', 0, 1, 0.01).name('摩擦');


document.addEventListener("click", (e) => {
  const numParticles = params.count;
  for (let i = 0; i < numParticles; i++) {
    createParticle(e.clientX, e.clientY);
  }
});

function createParticle(x, y) {
  const p = document.createElement("div");
  p.classList.add("particle");
  document.body.appendChild(p);

  gsap.set(p, { x: x, y: y, backgroundColor: gsap.utils.random(["#FF6F61", "#42C2F4", "#FAD02E"]) });

  gsap.to(p, {
    duration: gsap.utils.random(0.8, 1.5),
    physics2D: {
      angle: gsap.utils.random(params.angleMin, params.angleMax),    // 発射角度
      velocity: gsap.utils.random(params.velocityMin, params.velocityMax), // 速度(px/sec)
      gravity: params.gravity, // 下方向の重力
      friction: params.friction, // 摩擦（空気抵抗）0〜1
    },
    opacity: 0,
    onComplete: () => p.remove(),
    ease: "none"
  });
}
</script>

</body>
</html>
